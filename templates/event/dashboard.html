{%extends "index.html"%}

{%block media_location%}
   
                <link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}media1/style/css/main.css" />  
		<link rel="stylesheet" type="text/css" href="{{MEDIA_URL}}media1/style/css/events-tab.css" />   
		<script type="text/javascript" src="{{MEDIA}}media1/scripts/js/jquery-1.5.2-min.js"></script>
		<script type="text/javascript" src="{{MEDIA_URL}}media1/scripts/js/jquery.jscrollpane.min.js"></script>
		<script type="text/javascript" src="{{MEDIA_URL}}media1/scripts/js/jquery.mousewheel.js"></script>
		
                <script type="text/javascript">
			var elem=['intro','pstmnt','rules','faq','contact','extraTabs'];
                         var tot=0;
                        {%for row in tab_list%}
                             elem[{{forloop.counter0}}]='{{row.title|slugify}}';
                             tot=tot+1; 
                         {%endfor%}
                       
			var tabHeights=['420px','500px','600px','700px','800px','2000px'];
			//var i_=0,p=0,r=0,f=0,c=0,e=0;
			
			$(function(){
				$('#event-details').jScrollPane({showArrows: true});
			});
			window.onload=function(){		
				document.getElementById('page').style.display="block";
				setVisible(elem[0]);
				setBgGreen(elem[0]);
			}

			$(document).ready(function() {
				$("#tabs").click(function(e) {
					var id=e.target.id;
					setBgGreen(id);
					setVisible(id);							
				});	
			
			});
			
			function setVisible(e){
				document.getElementById(e+'_').style.visibility="visible";
				
				for(i=0;i<tot;i++)	if(elem[i]==e)	document.getElementById('jspPane').style.height=tabHeights[i];
				for(i=0;i<tot;i++)	if(elem[i]!=e)	document.getElementById(elem[i]+'_').style.visibility="hidden";
				for(i=0;i<tot;i++)	if(elem[i]!=e)	document.getElementById(elem[i]+'_').style.height="0px"; 
				
				$(function(){$('#event-details').jScrollPane({showArrows: true});});
			}
			
			function setBgGreen(e){
				document.getElementById(e).style.backgroundColor="#93C66E";
				for(i=0;i<tot;i++)	if(elem[i]!=e)	document.getElementById(elem[i]).style.backgroundColor="#5185BE";
			}
		</script>
  
               

<!--<script src="http://code.jquery.com/jquery-latest.js"></script>-->


{%endblock%}



{%block body%}

{{event_name}}
 <div id="eventsTab">
			<div id="tabs">

                             {% for row in tab_list%}
				<div id="{{row.title|slugify }}">{{row.title}}</div>
			    <!--<div id="pstmnt">Problem Statement</div>
				<div id="rules">Rules</div>
				<div id="faq">FAQ</div>
				<div id="contact">Contact</div>	
			    	<div id="extraTabs">More Tabs Here</div>-->
                            {%endfor%}				
			</div>
                        
			<div id="event-details">
                              {%for row in tab_list %}
				<div id="{{row.title|slugify }}_">

                                  <!--The Edit Event button -->
   
          <div id="edit_event">
              {%if user.is_authenticated%} 
                    <form action= "{{SITE_URL}}events/dashboard/edit_event/" method="GET">
                       {% csrf_token %}
                    <input type="submit" value="Edit Event Details" />
                    </form>
             {%endif%}
          </div>
          
          <!-- Button to see users who have registered for this event -->
           
           <!-- Logout button -->

           <div id="logout">
               {%if user.is_authenticated%} 
                    <form action= "{{SITE_URL}}events/logout/" method="POST">
                      {% csrf_token %}
                    <input type="submit" value="LOGOUT" />
                    </form>
              {%endif%}
           </div>
              
     


                                       {%if not row.question_tab%}
			ROW ID : {{row.id}} 
			<br />
			ROW PREFERENCE : {{row.pref}} 
			<br />
			<p>{{row.text|safe}}</p>
			<br /><br />

                        <!-- displaying file list -->
 
			<div id="file_display">
                             <div id="file_header">
			         CURRENTLY UPLOADED FILES:
			      </div>
                           
			           <br/>
                              <!-- displaying the file urls -->

                               <div id="file_content"> 
			           {%for file in row.file_list %}
			               <a href={{file.url}}>{{file.title}}</a>
		                       <br/>
			           {%endfor%}
                               </div>
			            <br/>
                        </div>

               <!-- The edit tab Button -->
               
               <div id="edit_tab">
                    <form action="edit_tab/" method = 'GET'>
            	       {% csrf_token %}
	            <input type="hidden" value="{{row.id}}" name=tab_id >
	            <input type="submit" value="Edit Tab">
                    </form>
               </div>

                 
 
           {%else%}

                     {% for ques in ques_list %}
	              <!-- for now the whole question is the href. later we can get an image of + sign before the question and make only that href -->
                            <div id="Ques{{ques.Q_Number}}">
                            <a href="#Question{{ques.Q_Number}}">{{ques.Q_Number}}. {{ques.title|safe}}</a><br/>
                            </div>         
                     

        
                   
	             
	                  <div id="Question{{ques.Q_Number}}">
			                               

                                 <!-- The answer Form -->
               
                                 <div id="form{{ques.Q_Number}}">
                                    <form action="" method="POST" enctype="multipart/form-data">
		                     {% csrf_token %}
		                     <table>
		                     {% if ques.question_type == "NORMAL" %}
                                <p>Type your answer in the textarea and hit the "Submit" button.</p>
                                <textarea rows="6" cols="40" >This is not fully functional right now. Clicking on submit does nothing.</textarea><br/>
                                <input type="submit" value="Submit">
                             {% else %}
                                {% if ques.question_type == "MCQ" %}
                                <p>This is a multiple choice question. Please select your choice and click on "Submit".</p>
                                <p> This will be functional soon.</p>
                                {% else %}
                                <p> Choose the file you want to upload and click on "Upload".</p>
                                <p> This will be functional soon.</p>
                                    <br/>
                                    <input type="file" name="blah" size="30"><br/>
                                    <input type="submit" value="Upload">
                                {% endif %}
		                     {% endif %}
		                    </table>
		      
                              <br /><br />
                                
                                 <!-- the delete question button -->
   
                                <div id="delete_question">
                                 <form action="{{SITE_URL}}events/dashboard/delete_question/" method = 'POST'>
		                     {% csrf_token %}
		                 <input type="hidden" value="{{ques.id}}" name=ques_id>
		                 <input type="submit" value="Delete Question">
                                   </form>
                                 </div>

                                 <!-- the edit question button -->

                                   <div id="edit_question">
                                   <form action="edit_question/" method = 'GET'>
            	                        {% csrf_token %}
	                            <input type="hidden" value="{{ques.id}}" name=ques_id >
	                            <input type="submit" value="Edit Question">
                                  </form>
                                  </div>





	                        </form>
                              </div>   
                         </div> 
                       <br />


                      
                      
                    
                 
                      

                  <script>
                     $("#Question{{ques.Q_Number}}").hide();
                     $("#Ques{{ques.Q_Number}}").click(function () {
                     $("#Question{{ques.Q_Number}}").toggleClass("inactive").slideToggle("slow");
                       });
                 </script>

                  {%endfor%}
         	<br/><br/>


     


        <!-- the SAVE ANSWERS button -->
        <!-- once clicked will be redirected to the testevent page-->

	<!--<div id="save_answers">
           <form action="" method ="POST">
	      {% csrf_token %}
           
	   <input type="submit" value="Save Answers" />
	   </form>
	</div>-->


        <!-- the freeze answers button -->

       <!-- <div id="freeze_answers">
              <form action="freeze_answers/" method ="POST">
	      {% csrf_token %}
             
	      <input type="submit" value="Freeze Answers" />
	      </form>
	</div>-->  






              <div id="add_question">
           <form action="add_question/" method ="POST">
	      {% csrf_token %}
           <input type="hidden" value="{{row.id}}" name="tab_id" />
	   <input type="submit" value="Add Questions" />
	   </form>
	</div>          
                 

   
           {%endif%}



               <!--the delete tab button --> 
                  
                   <div id="delete_tab">
                      <form action="delete_tab/" method = 'POST'>
		        {% csrf_token %}
		      <input type="hidden" value="{{row.id}}" name=tab_id>
		      <input type="submit" value="Delete Tab">
                      </form>
                   </div>
    
				</div>
                              {%endfor%}
					</div>
		</div>
		
	          
             <br/><br/>

    <!-- the add tab button -->
	<div id="add_tab">
           <form action="add_tab/" method ="POST">
	      {% csrf_token %}
           <input type="hidden" value="{{row.id}}" name="tab_id" />
	   <input type="submit" value="Add Tab" />
	   </form>
	</div>  
	<!-- the add questions tab button -->
	{%if not questions_added %}
	<div id="add_questions_tab">
           <form action="add_questions_tab/" method ="POST">
          {% csrf_token %}
           <input type="hidden" value="{{row.id}}" name="tab_id" />
       <input type="submit" value="Add Questions" />
       </form>
    </div>  
	{% endif %}
		
	<div id="preload" style="visibility:hidden; height:0px;">
		<img src="intro_.png" />
		<img src="pstmnt_.png" />
		<img src="rules_.png" />
		<img src="faq_.png" />
		<img src="contact_.png" />
	</div>
 


{%endblock%}
