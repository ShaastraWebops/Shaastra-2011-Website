{% extends "myshaastra/home.html" %}

{% block media_location %}

    <style>
        #list_of_members{
            width:33%;
        }
        #add_member_form{
            position:absolute;
            width:33%;
            left:33%;
            top:-10px;
        }
        #leader{
            position:absolute;
            width:33%;
            left:66%;
            top:-10px;
        }
        ul{list-style:none;}
        li a{text-decoration:none; color:black}
        h3 {text-decoration:none; font-family: Arial, Helvetica, sans-serif;}
    </style>

{% endblock %}

{% block body %}

    <div id="list_of_members">
        <h3>Members:</h3>
        {% if team.leader == user %}
            <p>Click to remove a member</p>
        {% endif %}
        <ul>
            {% for member in team.members.all %}
                {% if member != user %}
                    <li>
                        {% if team.leader == user %}
<!--                            <script type="text/javascript">
                                function submit_form_{{ member.id }}()
                                {
                                    document.remove_{{ member.id }}.submit();
                                }
                            </script>
                            <a href="javascript:submit_form_{{ member.id }}">   -->
                                {{ member.username }}
<!--                            </a>   -->
                            <form name="remove_{{ member.id }}" action="{{ SITE_URL }}myshaastra/teams/{{ team.id }}/remove_member/" method="POST">
                                {% csrf_token %}
                                <input type="hidden" name="new_leader" value="{{ member.username }}" />
                                <input type="hidden" name="team_id" value="{{ team.id }}" />
                                <div class="button2">
                                    <a href="#">
                                        <input type="submit" value="Remove" />
                                    </a>
                                    <span></span>
                                 </div>
                            </form>
                        {% else %}
                            {{ member.username }}
                        {% endif %}
                    </li>
                {% endif %}
            {% endfor %}
        </ul>
    </div>
    
    <br /><br><br>
    
    {% if team.leader == user %}
        <div id="add_member_form">
            <p>Add a member:</a>
            <form name="add_member" action="{{ SITE_URL }}myshaastra/teams/{{ team.id }}/add_member/" method="POST">
                {% csrf_token %}
                {{ add_member_form.member.errors }}
                <label for="id_member">Username:</label>
                {{ add_member_form.member }} 
                <input type="hidden" name="team_id" value="{{ team.id }}" />
                <p>
                    <div class="button2">
                        <a href="#">
                            <input type="submit" value="Add" />
                        </a>
                        <span></span>
                    </div>
                </p>
            </form>
        </div><br><br>
    {% else %}
        <script type="text/javascript">
            function submit_dropout_form()
            {
                document.dropout.submit();
            }
        </script>        
        <form name="dropout" action="{{ SITE_URL }}myshaastra/teams/{{ team.id }}/drop_out/" method="POST">
            {% csrf_token %}
            <input type="hidden" name="team_id" value="{{ team.id }}" />
        </form>
        <a href="javascript:submit_dropout_form()">Leave this team</a><br><br>
    {% endif %}

    {% if team.leader == user %}
        <h3>Change the team leader</h3>
        <div id="change_leader_form">
            <form action="{{ SITE_URL }}myshaastra/teams/{{ team.id }}/change_leader/" method="POST">
                {% csrf_token %}
                {{ change_leader_form.new_leader.errors }}
                <label for="id_new_leader">Pass on the leadership to:</label>
                {{ change_leader_form.new_leader }}
                <input type="hidden" name="team_id" value="{{ team.id }}">
                <div class="button2">
                    <a href="#">
                        <input type="submit" value="Change Leader" />
                    </a>
                    <span></span>
                </div>
            </form>
        </div><br><br>
    {% endif %}   

{% endblock %}
